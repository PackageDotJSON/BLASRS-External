<div class="card">
  <div class="card-header">
    <h6>Brokers Liquidity and Assets Segregation Review System</h6>
    <img src="assets/images/secplogo-2.png" alt="secp logo" height="130" />
    <h6 class="card-title">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="38"
        height="38"
        fill="currentColor"
        class="bi bi-lock"
        viewBox="0 0 16 16"
      >
        <path
          d="M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2zM5 8h6a1 1 0 0 1 1 1v5a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V9a1 1 0 0 1 1-1z"
        />
      </svg>
      Login
    </h6>
  </div>
  <div class="card-body">
    <form [formGroup]="authForm" (ngSubmit)="authenticate()">
      <div class="input-group">
        <span class="input-group-text" id="basic-addon1">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="18"
            height="18"
            fill="currentColor"
            class="bi bi-person"
            viewBox="0 0 16 16"
          >
            <path
              d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6Zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0Zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4Zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10Z"
            />
          </svg>
        </span>
        <input
          type="text"
          class="form-control"
          placeholder="CNIC (without dashes)"
          aria-label="CNIC"
          aria-describedby="basic-addon1"
          formControlName="userCnic"
        />
      </div>
      <ng-container
        *ngIf="
          authForm.get('userCnic')?.dirty || authForm.get('userCnic')?.touched
        "
      >
        <small
          class="custom-error"
          *ngIf="authForm.get('userCnic')?.errors?.['required']"
        >
          CNIC is required
        </small>
        <small
          class="custom-error"
          *ngIf="authForm.get('userCnic')?.errors?.['pattern']"
        >
          CNIC should consist of 13 digits
        </small>
      </ng-container>
      <div class="input-group">
        <span class="input-group-text" id="basic-addon1"
          ><svg
            xmlns="http://www.w3.org/2000/svg"
            width="18"
            height="18"
            fill="currentColor"
            class="bi bi-building"
            viewBox="0 0 16 16"
          >
            <path
              d="M4 2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1Zm3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1Zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1ZM4 5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1ZM7.5 5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1Zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1ZM4.5 8a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1Zm2.5.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1Zm3.5-.5a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h1a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5h-1Z"
            />
            <path
              d="M2 1a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V1Zm11 0H3v14h3v-2.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5V15h3V1Z"
            />
          </svg>
        </span>
        <input
          type="text"
          class="form-control"
          placeholder="CUIN"
          aria-label="CUIN"
          aria-describedby="basic-addon1"
          formControlName="userCuin"
        />
      </div>
      <ng-container
        *ngIf="
          authForm.get('userCuin')?.dirty || authForm.get('userCuin')?.touched
        "
      >
        <small
          class="custom-error"
          *ngIf="authForm.get('userCuin')?.errors?.['required']"
        >
          CUIN is required
        </small>
        <small
          class="custom-error"
          *ngIf="authForm.get('userCuin')?.errors?.['pattern']"
        >
          CUIN should consist of 7 digits
        </small>
      </ng-container>
      <div class="input-group">
        <span class="input-group-text" id="basic-addon1">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="18"
            height="18"
            fill="currentColor"
            class="bi bi-key"
            viewBox="0 0 16 16"
          >
            <path
              d="M0 8a4 4 0 0 1 7.465-2H14a.5.5 0 0 1 .354.146l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0L13 9.207l-.646.647a.5.5 0 0 1-.708 0L11 9.207l-.646.647a.5.5 0 0 1-.708 0L9 9.207l-.646.647A.5.5 0 0 1 8 10h-.535A4 4 0 0 1 0 8zm4-3a3 3 0 1 0 2.712 4.285A.5.5 0 0 1 7.163 9h.63l.853-.854a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.793-.793-1-1h-6.63a.5.5 0 0 1-.451-.285A3 3 0 0 0 4 5z"
            />
            <path d="M4 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0z" />
          </svg>
        </span>
        <input
          type="password"
          class="form-control"
          placeholder="PIN"
          aria-label="PIN"
          aria-describedby="basic-addon1"
          formControlName="userPin"
        />
      </div>
      <ng-container
        *ngIf="
          authForm.get('userPin')?.dirty || authForm.get('userPin')?.touched
        "
      >
        <small
          class="custom-error"
          *ngIf="authForm.get('userPin')?.errors?.['required']"
        >
          PIN is required
        </small>
        <small
          class="custom-error"
          *ngIf="authForm.get('userPin')?.errors?.['pattern']"
        >
          PIN should consist of 4 digits
        </small>
      </ng-container>
      <br />
      <button
        type="submit"
        class="btn btn-outline-success"
        [disabled]="authForm.invalid"
      >
        Sign In
      </button>
    </form>
    <app-loader *ngIf="isResponseValid"></app-loader>
  </div>
  <div class="card-footer">
    <small>Developed by IS&TD</small>
  </div>
</div>

<ng-container *ngIf="serverResponse$ | async as response">
  <app-toast
    [toastColor]="response.error === false ? 'bg-success' : 'bg-danger'"
    [toastOperation]="response.statusCode === 200 ? 'Success' : 'Failure'"
    [toastMessage]="response.message"
  ></app-toast>
</ng-container>
